<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ContaTienda</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <main id="login-view" class="view">
            <div class="login-card">
                <h1>ContaTienda</h1>
                <p class="subtitle">Gesti贸n contable simple para tu tienda</p>
                <form id="login-form">
                    <label for="username">Usuario</label>
                    <input type="text" id="username" autocomplete="username" required>

                    <label for="password">Contrase帽a</label>
                    <input type="password" id="password" autocomplete="current-password" required>

                    <button type="submit" class="btn primary">Ingresar</button>
                    <p id="login-error" class="error" aria-live="polite"></p>
                </form>
                <div class="hint">
                    <strong>Demo:</strong> u123/123, u1234/1234
                </div>
            </div>
        </main>

        <div id="app-layout" class="hidden">
            <section class="content">
                <header class="topbar">
                    <div class="topbar-main">
                        <div class="brand">ContaTienda</div>
                        <div class="top-actions">
                            <button id="reload-btn" class="btn outline" title="Recargar datos del servidor"> Recargar</button>
                            <button id="logout-btn" class="btn outline">Salir</button>
                        </div>
                    </div>
                    <div class="topnav">
                        <button data-nav="dashboard" class="nav-item active">Dashboard</button>
                        <button data-nav="ventas" class="nav-item">Registrar Ventas</button>
                        <button data-nav="egresos" class="nav-item">Registrar Egresos</button>
                        <button data-nav="deudas" class="nav-item">Gestionar Deudas</button>
                    </div>
                    <h2 id="section-title" class="sr-only">Dashboard</h2>
                </header>

                <div id="dashboard-view" class="view">
                    <div class="cards">
                        <div class="card">
                            <div class="card-label">Total Ingresos</div>
                            <div class="card-value" id="total-ventas">$0</div>
                        </div>
                        <div class="card">
                            <div class="card-label">Total Egresos</div>
                            <div class="card-value" id="total-egresos">$0</div>
                        </div>
                        <div class="card">
                            <div class="card-label">Deudas Pendientes</div>
                            <div class="card-value" id="total-deudas">$0</div>
                        </div>
                    </div>

                    <div class="grid">
                        <div class="panel">
                            <div class="panel-header">
                                <h3>Movimientos mensuales</h3>
                            </div>
                            <canvas id="chart-monthly" width="900" height="220" aria-label="Gr谩fico mensual de ventas y egresos" role="img"></canvas>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><h3>Distribuci贸n mensual (d铆as)</h3></div>
                            <canvas id="chart-monthly-days" width="900" height="220" aria-label="Gr谩fico por d铆as del mes actual de ventas y egresos" role="img"></canvas>
                        </div>
                    </div>

                    <div class="grid">
                        <div class="panel">
                            <div class="panel-header"><h3>Distribuci贸n diaria (24h)</h3></div>
                            <canvas id="chart-daily" width="900" height="220" aria-label="Gr谩fico por hora (24h) de ventas y egresos" role="img"></canvas>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><h3>Distribuci贸n semanal (Lun-Dom)</h3></div>
                            <canvas id="chart-weekly" width="900" height="220" aria-label="Gr谩fico por d铆a de semana de ventas y egresos" role="img"></canvas>
                        </div>
                    </div>

                    <div class="grid">
                        <div class="panel">
                            <div class="panel-header"><h3>ltimas Ventas</h3></div>
                            <table class="table" id="tabla-ult-ventas">
                                <thead>
                                    <tr><th>Fecha</th><th>Monto</th><th>Notas</th></tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><h3>ltimos Egresos</h3></div>
                            <table class="table" id="tabla-ult-egresos">
                                <thead>
                                    <tr><th>Fecha</th><th>Monto</th><th>Descripci贸n</th></tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="ventas-view" class="view hidden">
                    <div class="panel">
                        <div class="panel-header">
                            <h3>Registrar Venta</h3>
                        </div>
                        <form id="form-venta" class="form-grid">
                            <div>
                                <label for="venta-monto">Monto</label>
                                <input type="number" id="venta-monto" min="0" step="0.01" required>
                            </div>
                            <div>
                                <label for="venta-fecha">Fecha</label>
                                <input type="date" id="venta-fecha" required>
                            </div>
                            <div class="full">
                                <label for="venta-notas">Notas</label>
                                <input type="text" id="venta-notas" placeholder="Opcional">
                            </div>
                            <div class="full">
                                <button type="submit" class="btn primary">Guardar</button>
                                <span id="venta-msg" class="msg"></span>
                            </div>
                        </form>
                    </div>

                    <div class="panel">
                        <div class="panel-header"><h3>Ventas</h3></div>
                        <table class="table" id="tabla-ventas">
                            <thead>
                                <tr><th>Fecha</th><th>Monto</th><th>Notas</th><th></th></tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <div id="egresos-view" class="view hidden">
                    <div class="panel">
                        <div class="panel-header">
                            <h3>Registrar Egreso</h3>
                        </div>
                        <form id="form-egreso" class="form-grid">
                            <div>
                                <label for="egreso-monto">Monto</label>
                                <input type="number" id="egreso-monto" min="0" step="0.01" required>
                            </div>
                            <div>
                                <label for="egreso-fecha">Fecha</label>
                                <input type="date" id="egreso-fecha" required>
                            </div>
                            <div class="full">
                                <label for="egreso-desc">Descripci贸n</label>
                                <input type="text" id="egreso-desc" required>
                            </div>
                            <div class="full">
                                <button type="submit" class="btn primary">Guardar</button>
                                <span id="egreso-msg" class="msg"></span>
                            </div>
                        </form>
                    </div>

                    <div class="panel">
                        <div class="panel-header"><h3>Egresos</h3></div>
                        <table class="table" id="tabla-egresos">
                            <thead>
                                <tr><th>Fecha</th><th>Monto</th><th>Descripci贸n</th><th></th></tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <div id="deudas-view" class="view hidden">
                    <div class="panel">
                        <div class="panel-header">
                            <h3>Gestionar Deuda</h3>
                        </div>
                        <form id="form-deuda" class="form-grid">
                            <div>
                                <label for="deuda-comprador">Comprador</label>
                                <input type="text" id="deuda-comprador" required>
                            </div>
                            <div>
                                <label for="deuda-monto">Monto</label>
                                <input type="number" id="deuda-monto" min="0" step="0.01" required>
                            </div>
                            <div>
                                <label for="deuda-fecha">Fecha</label>
                                <input type="date" id="deuda-fecha" required>
                            </div>
                            <div>
                                <label for="deuda-estado">Estado</label>
                                <select id="deuda-estado">
                                    <option value="pendiente">Pendiente</option>
                                    <option value="pagado">Pagado</option>
                                </select>
                            </div>
                            <div class="full">
                                <button type="submit" class="btn primary">Guardar</button>
                                <span id="deuda-msg" class="msg"></span>
                            </div>
                        </form>
                    </div>

                    <div class="panel">
                        <div class="panel-header"><h3>Deudas</h3></div>
                        <table class="table" id="tabla-deudas">
                            <thead>
                                <tr><th>Comprador</th><th>Fecha</th><th>Monto</th><th>Estado</th><th></th></tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script src="app.js"></script>
    <noscript>Por favor activa JavaScript para usar esta aplicaci贸n.</noscript>
    <script>
        // set default date inputs to today
        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date().toISOString().slice(0,10);
            const ids = ['venta-fecha', 'egreso-fecha', 'deuda-fecha'];
            ids.forEach(id => { const el = document.getElementById(id); if (el) el.value = today; });
        });
    </script>
</body>
</html>


